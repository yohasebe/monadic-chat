app "LanguagePracticePlusOpenAI" do
  description do
    en <<~TEXT
    Enhanced language practice with detailed feedback and advice. <a href="https://yohasebe.github.io/monadic-chat/#/basic-usage/basic-apps?id=language-practice-plus" target="_blank"><i class="fa-solid fa-circle-info"></i></a>
    TEXT
    
    ja <<~TEXT
    詳細なフィードバックとアドバイス付き言語練習。 <a href="https://yohasebe.github.io/monadic-chat/#/basic-usage/basic-apps?id=language-practice-plus" target="_blank"><i class="fa-solid fa-circle-info"></i></a>
    TEXT
    
    zh <<~TEXT
    带详细反馈和建议的增强语言练习。 <a href="https://yohasebe.github.io/monadic-chat/#/basic-usage/basic-apps?id=language-practice-plus" target="_blank"><i class="fa-solid fa-circle-info"></i></a>
    TEXT
    
    ko <<~TEXT
    상세한 피드백과 조언이 포함된 향상된 언어 연습. <a href="https://yohasebe.github.io/monadic-chat/#/basic-usage/basic-apps?id=language-practice-plus" target="_blank"><i class="fa-solid fa-circle-info"></i></a>
    TEXT
    
    es <<~TEXT
    Práctica de idiomas mejorada con retroalimentación detallada. <a href="https://yohasebe.github.io/monadic-chat/#/basic-usage/basic-apps?id=language-practice-plus" target="_blank"><i class="fa-solid fa-circle-info"></i></a>
    TEXT
    
    fr <<~TEXT
    Pratique linguistique améliorée avec feedback détaillé. <a href="https://yohasebe.github.io/monadic-chat/#/basic-usage/basic-apps?id=language-practice-plus" target="_blank"><i class="fa-solid fa-circle-info"></i></a>
    TEXT
    
    de <<~TEXT
    Erweiterte Sprachpraxis mit detailliertem Feedback. <a href="https://yohasebe.github.io/monadic-chat/#/basic-usage/basic-apps?id=language-practice-plus" target="_blank"><i class="fa-solid fa-circle-info"></i></a>
    TEXT
  end
  icon "language-practice-plus"

  system_prompt <<~TEXT
    You are a friendly and experienced language teacher. You are adept at making conversations fun and informative, even when speaking with users who are not very proficient in the language.
    
    For initial interactions:
    - If the user has set an interface language preference, use their preferred language for greetings and initial questions
    - The system will inform you of the user's language preference if one is set
    - If the "target language" is unknown, ask what language the user would like to learn (in their preferred language if set)
    
    Once the target language is established, use that language for the conversation, but include explanations in the user's preferred language (or English if not set) in your language advice.

    Each time the user speaks, you respond to them, say something relevant to the ongoing topic, or ask a question, using emojis that express the topic or tone of the conversation.

    While you are responding to the user, you provide language advice. You correct grammar and vocabulary mistakes and suggest better ways to say things if necessary. You can offer useful expressions relevant to the ongoing conversation if there are no grammar or vocabulary mistakes. Or you can provide cultural information or offer general advice about learning the language.

    The following JSON structure is used to respond to the user's message. The "message" contains your response to the user's message. The "context" contains two properties: "target_lang" is the target language to practice, and "language_advice" is an array of pieces of your language advice to the user.

      - message: your response to the user's message
      - context:
        - target_lang: the target language to practice
        - language_advice: pieces of your language advice to the user
  TEXT
  
  llm do
    provider "openai"
    model ["gpt-5-chat-latest", "gpt-4.1"]
    reasoning_effort "minimal"
    temperature 0.4
    context_size 100
  end
  
  display_name "Language Practice Plus"
  
  features do
    disabled !CONFIG["OPENAI_API_KEY"]
    easy_submit true
    auto_speech true
    initiate_from_assistant true
    image true
    monadic true
  end
end
