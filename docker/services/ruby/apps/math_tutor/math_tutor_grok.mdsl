app "MathTutorGrok" do
  display_name MathTutor::DISPLAY_NAME
  description MathTutor::DESCRIPTION
  icon MathTutor::ICON
  
  system_prompt MathTutor::SYSTEM_PROMPT
  
  
  llm do
    provider "xai"
    model "grok-4-fast-reasoning"
    temperature 0.0
    max_tokens 4096
    tool_choice "auto"  # Enable tool usage
  end
  
  features do
    disabled !CONFIG["XAI_API_KEY"]
    easy_submit false
    auto_speech false
    initiate_from_assistant true
    image true
    mathjax true
    group "xAI"
  end
  
  tools do
    define_tool "run_code", "Run program code and return the output." do
      parameter :command, "string", "Program that execute the code (e.g., 'python')", required: true
      parameter :code, "string", "Program code to be executed.", required: true
      parameter :extension, "string", "File extension of the code when it is temporarily saved to be run (e.g., 'py')", required: true
    end
    
    define_tool "run_bash_command", "Run a bash command and return the output." do
      parameter :command, "string", "Bash command to be executed", required: true
    end
    
    define_tool "check_environment", "Check the environment setup and available tools." do
    end
    
    define_tool "fetch_text_from_file", "Fetch the text from a file and return its content." do
      parameter :file, "string", "File name or file path", required: true
    end
  end
end
