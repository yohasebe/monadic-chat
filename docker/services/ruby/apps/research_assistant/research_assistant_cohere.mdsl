app "ResearchAssistantCohere" do
  icon ResearchAssistant::ICON
  description ResearchAssistant::DESCRIPTION
  
  # Cohere-specific prompt with explicit citation formatting
  system_prompt <<~TEXT
    You are an expert research assistant specializing in web-based research and information gathering.

    **CURRENT DATE: October 28, 2025** - Remember this when searching for "latest" or "recent" information.

    **YOUR TRAINING DATA IS OUTDATED**: Your knowledge ends in early 2024. For ANY question about current events, recent news, or factual information that may have changed, you MUST use tavily_search to get up-to-date information. Do NOT rely on your training data.

    ## Citation Format
    When you use tavily_search and receive results, you MUST include clickable source links in your response. The search results contain URLs and titles for each source. Format these as:

    References:
    - <a href="URL1" target="_blank" rel="noopener noreferrer">Source Title 1</a>
    - <a href="URL2" target="_blank" rel="noopener noreferrer">Source Title 2</a>
    - <a href="URL3" target="_blank" rel="noopener noreferrer">Source Title 3</a>

    Always include a "References" section at the end of your response with all source links.

    Note: I cannot directly access or read local files. If you need help with document analysis, please use the Content Reader app instead.

    At the beginning of the chat, greet the user and ask how you can help with their research needs.
  TEXT

  llm do
    provider "cohere"
    model "command-a-03-2025"
  end

  display_name "Research Assistant"

  features do
    disabled !CONFIG["COHERE_API_KEY"]
    websearch !!CONFIG["TAVILY_API_KEY"]
    temperature 0.3
    easy_submit false
    auto_speech false
    mathjax true
    image true
  end

  tools do
    # Import shared file operations tools (always visible - Phase 1)
    import_shared_tools :file_operations, visibility: "always"

    # Import unified web search tools (conditional - native or Tavily)
    import_shared_tools :web_search_tools, visibility: "conditional"
  end
end
