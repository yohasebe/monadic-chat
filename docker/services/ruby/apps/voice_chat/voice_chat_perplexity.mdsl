app "VoiceChatPerplexity" do
  description do
    en <<~TEXT
    Conversational AI with voice input and output support. <a href="https://yohasebe.github.io/monadic-chat/#/basic-usage/basic-apps?id=voice-chat" target="_blank"><i class="fa-solid fa-circle-info"></i></a>
    TEXT
    
    ja <<~TEXT
    音声入出力をサポートする会話AI。 <a href="https://yohasebe.github.io/monadic-chat/#/basic-usage/basic-apps?id=voice-chat" target="_blank"><i class="fa-solid fa-circle-info"></i></a>
    TEXT
    
    zh <<~TEXT
    支持语音输入输出的对话AI。 <a href="https://yohasebe.github.io/monadic-chat/#/basic-usage/basic-apps?id=voice-chat" target="_blank"><i class="fa-solid fa-circle-info"></i></a>
    TEXT
    
    ko <<~TEXT
    음성 입출력을 지원하는 대화 AI. <a href="https://yohasebe.github.io/monadic-chat/#/basic-usage/basic-apps?id=voice-chat" target="_blank"><i class="fa-solid fa-circle-info"></i></a>
    TEXT
    
    es <<~TEXT
    IA conversacional con soporte de entrada y salida de voz. <a href="https://yohasebe.github.io/monadic-chat/#/basic-usage/basic-apps?id=voice-chat" target="_blank"><i class="fa-solid fa-circle-info"></i></a>
    TEXT
    
    fr <<~TEXT
    IA conversationnelle avec entrée et sortie vocales. <a href="https://yohasebe.github.io/monadic-chat/#/basic-usage/basic-apps?id=voice-chat" target="_blank"><i class="fa-solid fa-circle-info"></i></a>
    TEXT
    
    de <<~TEXT
    Konversations-KI mit Spracheingabe und -ausgabe. <a href="https://yohasebe.github.io/monadic-chat/#/basic-usage/basic-apps?id=voice-chat" target="_blank"><i class="fa-solid fa-circle-info"></i></a>
    TEXT
  end
  
  icon "microphone"
  
  system_prompt <<~PROMPT
  You are a friendly chat buddy having a casual conversation with the user. Focus on natural dialogue without searching for information unless specifically asked.

  IMPORTANT guidelines for natural conversation:
  - Respond conversationally without searching for facts unless the user asks a specific question
  - Keep responses brief (under 50 words) for voice playback
  - For greetings like "Hi" or "How are you?", respond naturally without web searches
  - Only use web search when the user asks for specific information or facts
  - Never include citation URLs, only citation numbers in brackets if needed
  - Start conversations with a warm, personal greeting, not with searched information
  PROMPT
  
  llm do
    provider "perplexity"
    model "sonar"
  end
  
  display_name "Voice Chat"
  
  features do
    disabled !CONFIG["PERPLEXITY_API_KEY"]
    easy_submit true
    auto_speech true
    group "Perplexity"
    initiate_from_assistant true
  end
end
