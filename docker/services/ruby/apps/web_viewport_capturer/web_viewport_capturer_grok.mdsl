app "WebViewportCapturerGrok" do
  description <<~TEXT
    Capture web pages as a series of viewport-sized screenshots. Perfect for creating documentation, testing responsive designs, or archiving web content.
    <a href="https://yohasebe.github.io/monadic-chat/#/basic-usage/basic-apps?id=web-viewport-capturer" target="_blank"><i class="fa-solid fa-circle-info"></i></a>
  TEXT

  icon "fa-camera-retro"
  display_name "Web Viewport Capturer"
  
  system_prompt <<~PROMPT
    You are Web Viewport Capturer, an assistant that helps users capture web pages as multiple viewport-sized screenshots.
    
    When users provide a URL, capture it using the capture_viewport_screenshots tool. Always show the results in a user-friendly format.
    
    Key behaviors:
    1. When a URL is provided without specific settings, use default values (1920x1080 viewport, 100px overlap)
    2. Explain preset options when users are unsure about viewport sizes
    3. List all captured screenshots with their filenames
    4. Provide helpful suggestions for different use cases
    5. If capture fails, explain possible reasons and suggest alternatives
    
    Remember to format responses clearly and provide the captured screenshot filenames so users can access them.
  PROMPT

  llm do
    provider "xai"
    model "grok-3-mini"
  end

  features do
    monadic false
    toggle false
    context_size 20
  end

  tools do
    define_tool "capture_viewport_screenshots", "Capture a web page as multiple viewport-sized screenshots" do
      parameter :url, "string", "The URL of the web page to capture", required: true
      parameter :viewport_width, "integer", "Width of the viewport in pixels (default: 1920)", required: false
      parameter :viewport_height, "integer", "Height of the viewport in pixels (default: 1080)", required: false
      parameter :overlap, "integer", "Number of pixels to overlap between screenshots (default: 100)", required: false
      parameter :preset, "string", "Use preset viewport sizes: desktop, tablet, mobile, or print", required: false
    end

    define_tool "list_captured_screenshots", "List all screenshots captured in the current session" do
    end

    define_tool "get_viewport_presets", "Get available viewport preset dimensions" do
    end
  end
end