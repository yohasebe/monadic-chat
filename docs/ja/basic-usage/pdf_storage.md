# PDFストレージモード

Monadic Chatは、PDFドキュメントを保存および検索するための2つの方法を提供しています。ローカルPDF（PGVectorを使用）とクラウドPDF（OpenAI Vector Storeを使用）です。この柔軟性により、完全なローカル制御とクラウドホスト型の利便性のどちらかを選択できます。

## ストレージモードについて

### ローカルPDF（PGVector）

ローカルストレージモードは、マシン上でPDFを処理し、pgvector拡張機能を備えたPostgreSQLデータベースに保存します。これにより、データを完全にコントロールできます。

- PDFはテキスト埋め込みに変換されてローカルに保存されます
- すべての処理がコンピュータ上で行われます
- データはPGVector Dockerコンテナに永続化されます
- ドキュメントを完全にローカル制御したい場合に推奨されます

### クラウドPDF（OpenAI Vector Store）

クラウドストレージモードは、PDFをOpenAIのサーバーにアップロードし、検索にVector Storeサービスを使用します。

- PDFはOpenAI Filesにアップロードされます
- ドキュメントは共有Vector Storeに添付されます
- OpenAIがすべてのインデックス作成と検索操作を処理します
- ゼロセットアップの利便性を求める場合や、すでにOpenAIサービスを使用している場合に推奨されます

## ストレージモードの選択

設定パネルの「PDFストレージモード」で、希望するストレージモードを選択できます。

- **ローカル（PGVector）** - デフォルトオプション、すべてをローカルに保存
- **クラウド（OpenAI Vector Store）** - OpenAIのホステッドサービスを使用

## PDFコレクションの管理

### PDFデータベースパネル

WebインターフェースのPDFデータベースパネルは、ローカルストレージとクラウドストレージの両方に対して一貫したインターフェースでドキュメントコレクションを表示します。

- **更新**：最近追加されたドキュメントを表示するためにリストを更新します
- **削除（項目ごと）**：確認付きで個別のPDFを削除します
- **すべてクリア**：確認付きですべてのPDFを削除します

クラウドストレージにPDFをアップロードすると、リストが自動的に更新されて新しいドキュメントが表示されます。

## 検索の仕組み

検索エクスペリエンスは、ストレージモードによって若干異なります。

**ローカルモード**：
- PostgreSQLのpgvector拡張機能を使用した類似性検索
- 検索は完全にマシン上で行われます
- 検索のための外部API呼び出しはありません

**クラウドモード**：
- OpenAI File SearchをAPI呼び出しに自動的に統合します
- 検索はOpenAIのVector Storeサービスによって処理されます
- 結果はOpenAIのサーバーから取得されます

## 重要な注意事項

### クラウドモードの考慮事項

クラウドストレージを使用する際は、以下の点に注意してください。

- **データの場所**：PDFはOpenAIアカウントに保存されます
- **コスト**：OpenAI Vector Storeの料金については、[OpenAI API Pricing](https://openai.com/api/pricing/)を参照してください

### ローカルモードの考慮事項

ローカルストレージを使用する際：

- **データの永続化**：ドキュメントはPGVector Dockerボリュームに保存されます
- **バックアップ**：Electronメニューのドキュメントデータベースのエクスポート機能を使用してデータをバックアップしてください
- **コンテナの再構築**：データ損失を防ぐため、コンテナを再構築する前にデータベースをエクスポートしてください

## 削除動作

### ファイルごとの削除
- **ローカル**：PGVectorデータベースからドキュメントを削除します
- **クラウド**：OpenAI Filesからファイルを削除し、Vector Storeから削除します

### すべてクリア
- **ローカル**：PGVectorデータベースからすべてのドキュメントを削除します
- **クラウド**：Vector Storeから添付されているすべてのファイルを削除します

?> Vector Storeからすべてのファイルをクリアした後、検索コーパスが空になるため、検索は結果を返しません。
