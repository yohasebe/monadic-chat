<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Downloading Update</title>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
      padding: 20px;
      text-align: center;
    }
    progress {
      width: 100%;
      height: 20px;
      margin-top: 15px;
    }
    .status {
      margin-top: 10px;
      font-size: 12px;
      color: #666;
    }
  </style>
</head>
<body>
  <h4>Downloading Update...</h4>
  <progress id="progressBar" value="0" max="100"></progress>
  <div id="progressText" class="status">0%</div>
  <div id="speedText" class="status"></div>
  
  <script>
    // Preload script will expose this method
    window.addEventListener('message', (event) => {
      if (event.data.type === 'update-progress') {
        const progress = event.data.progress;
        const progressBar = document.getElementById('progressBar');
        const progressText = document.getElementById('progressText');
        const speedText = document.getElementById('speedText');
        
        progressBar.value = progress.percent || 0;
        progressText.textContent = `${Math.round(progress.percent || 0)}%`;
        
        if (progress.bytesPerSecond) {
          const speed = (progress.bytesPerSecond / 1024 / 1024).toFixed(2);
          const transferred = (progress.transferred / 1024 / 1024).toFixed(2);
          const total = (progress.total / 1024 / 1024).toFixed(2);
          speedText.textContent = `${speed} MB/s - ${transferred} MB / ${total} MB`;
        }
      }
    });
  </script>
</body>
</html>
